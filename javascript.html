<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<script>

  function generate() {
    let folderUrl = $("#folderUrl").val().trim();
    if(folderUrl.length !== 0) {
      generateByFolderUrl(folderUrl);
      return;
    } else {
      generateByFeatureName();
    }
  }

  function generateByFolderUrl(folderUrl) {
    let templateType = parseInt($("input[name='templateType']:checked").val());
    if(!templateType) {
      $("#message").text('Check the template you want to copy');
      return;
    }

    console.log(folderUrl);
    console.log(templateType);

    $("#message").text('');
    $("#submitButton").hide();
    $("#url").text('Generating...');
    google.script.run.withSuccessHandler(showUrl)
                        .withFailureHandler(showError)
                        .executeCopyTemplateByUrl(folderUrl, templateType);
  }

  function generateByFeatureName() {
    let version = $("input[name='version']:checked").val();
    console.log(version);
    if(version === undefined) {
      console.log('Please select a version');
      $("#message").text('Please select a version');
      return;
    }

    let featureName = $("#featureName").val().trim();
    console.log(featureName);
    if(featureName.length === 0) {
      $("#message").text('Please enter the target feature name');
      return;
    }

    let templateType = parseInt($("input[name='templateType']:checked").val());
    if(!templateType) {
      $("#message").text('Check the template you want to copy');
      return;
    }

    $("#message").text('');
    $("#submitButton").hide();
    $("#url").text('Generating...');
    console.log(templateType);
    google.script.run.withSuccessHandler(showUrl)
                        .withFailureHandler(showError)
                        .executeCopyTemplate(version, featureName, templateType);
  }

  function showUrl(url) {
    console.log(url);
    $('#url').html(`<a href="${url}" target="_blank">URL of the template file generated by copying</a>`);
    $("#submitButton").show();
  }

  function showError(error) {
    console.log(error);
    window.alert('An error has occurred. You can check it in the console tab of the development tool');
  }
</script>